import pandas as pd
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler

# Baca data dari file CSV
data = pd.read_csv('clustered_nutritional_data.csv')

# Pastikan kolom yang dibutuhkan ada di dalam data
print("Kolom yang tersedia dalam data:", data.columns)

# Buat fungsi untuk melakukan K-Means
def apply_kmeans(data, n_clusters):
    features = data[['calories', 'proteins', 'fat', 'carbohydrate']]  # Fitur yang digunakan untuk clustering
    scaler = StandardScaler()
    features_scaled = scaler.fit_transform(features)  # Normalisasi data
    
    kmeans = KMeans(n_clusters=n_clusters, random_state=0)
    kmeans.fit(features_scaled)
    
    data['cluster'] = kmeans.labels_  # Tambahkan label cluster ke data
    return data, kmeans

# Terapkan K-Means ke seluruh data
clustered_data, kmeans_model = apply_kmeans(data, n_clusters=3)

# Asosiasikan cluster dengan kategori makanan
def assign_meal_type(cluster_label):
    if cluster_label == 0:
        return 'breakfast'
    elif cluster_label == 1:
        return 'lunch'
    elif cluster_label == 2:
        return 'dinner'

clustered_data['meal_type'] = clustered_data['cluster'].apply(assign_meal_type)

# Tampilkan hasil
print("Clustered Data with Meal Types:")
print(clustered_data.head())